<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>KCGI Student Support Portal</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        :root {
            --logo-left-gap: 50px;
            --primary: #0f2a44;
            --secondary: #1f6feb;
            --light-bg: #f3f6fa;
        }

        body {
            margin: 0;
            font-family: Arial, sans-serif;
            background: var(--light-bg);
            color: #1c1c1c;
        }

        /* ================= TOP MENU ================= */
        nav {
            background: var(--primary);
            display: flex;
            justify-content: center;
            padding: 8px 0;
            position: sticky;
            top: 0;
            z-index: 2000;
        }

        .menu {
            display: flex;
            gap: 28px;
        }

        .menu-item {
            position: relative;
        }

        .menu-link {
            color: white;
            text-decoration: none;
            font-size: 14px;
            font-weight: bold;
            padding: 6px 10px;
            display: block;
            cursor: pointer;
        }

        .menu-link:hover {
            color: #ffd966;
        }

        .dropdown {
            display: none;
            position: absolute;
            background: white;
            min-width: 250px;
            top: 100%;
            left: 0;
            border-radius: 8px;
            box-shadow: 0 10px 22px rgba(0, 0, 0, 0.18);
            z-index: 100;
        }

        .dropdown a {
            display: block;
            padding: 12px 15px;
            color: #1c1c1c;
            text-decoration: none;
            font-size: 13px;
            border-bottom: 1px solid #eee;
        }

        .dropdown a:hover {
            background: #f3f6fa;
            color: var(--secondary);
        }

        .menu-item.active .dropdown {
            display: block;
        }

        /* ================= HEADER ================= */
        .kcgi-header {
            position: relative;
            background: linear-gradient(135deg, #0f2a44, #163b5f);
            padding: 15px 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .kcgi-logo {
            width: 200px;
            margin-bottom: 8px;
        }

        .kcgi-title {
            text-align: center;
            color: white;
        }

        .kcgi-title h1 {
            margin: 0;
            font-size: 22px;
        }

        .kcgi-title p {
            margin: 4px 0;
            font-size: 12px;
            color: #dce6f2;
        }

        .badge {
            display: inline-block;
            margin-top: 6px;
            padding: 4px 10px;
            border-radius: 20px;
            font-size: 11px;
            background: rgba(255, 255, 255, 0.15);
            color: #eaf1ff;
        }

        /* ================= SECTIONS ================= */
        section {
            padding: 40px 20px;
        }

        h2 {
            text-align: center;
            margin-bottom: 25px;
            color: var(--primary);
        }

        .card-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(230px, 1fr));
            gap: 18px;
        }

        .card {
            background: white;
            border-radius: 16px;
            padding: 22px;
            text-align: center;
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .card:hover {
            transform: translateY(-6px);
            box-shadow: 0 14px 28px rgba(0, 0, 0, 0.15);
        }

        .card-map {
            width: 100%;
            height: 300px;
            object-fit: contain;
            border-radius: 8px;
            background: #f2f2f2;
            padding: 1px;
            margin-bottom: 10px;
        }

        .info-box {
            background: #f8fbff;
            border-left: 4px solid var(--secondary);
            padding: 12px 14px;
            border-radius: 10px;
            margin: 10px 0;
            font-size: 14px;
            line-height: 1.6;
            text-align: left;
        }

        .read-more {
            color: var(--secondary);
            font-weight: bold;
            cursor: pointer;
            text-decoration: none;
        }

        .read-more:hover {
            text-decoration: underline;
        }

        button {
            background: var(--secondary);
            color: white;
            border: none;
            padding: 10px 16px;
            border-radius: 8px;
            cursor: pointer;
            margin: 6px;
        }

        button:hover {
            background: #174ea6;
        }

        /* ================= MODAL ================= */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            justify-content: center;
            align-items: center;
            z-index: 3000;
        }

        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 12px;
            max-width: 90%;
            max-height: 90%;
            width: 800px;
            position: relative;
            display: flex;
            flex-direction: column;
            height: 85vh;
            min-height: 500px;
        }

        .modal-title {
            text-align: center;
            margin-bottom: 20px;
            color: var(--primary);
            font-size: 24px;
            padding: 10px 0;
            flex-shrink: 0;
        }

        .close {
            cursor: pointer;
            position: absolute;
            right: 20px;
            top: 20px;
            font-size: 24px;
            background: rgba(0, 0, 0, 0.5);
            color: white;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 10;
        }

        .close:hover {
            background: rgba(0, 0, 0, 0.7);
        }

        /* ================= SLIDER FIX ================= */
        .slider-container {
            position: relative;
            flex: 1;
            overflow: hidden;
            border-radius: 10px;
            background: #f5f5f5;
            display: flex;
            flex-direction: column;
        }

        .slider-track {
            display: flex;
            height: 100%;
            transition: transform 0.5s ease-in-out;
            flex: 1;
        }

        .slide {
            min-width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            box-sizing: border-box;
            padding: 15px;
        }

        .slide-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .slide img {
            width: 100%;
            max-height: 350px;
            height: auto;
            object-fit: contain;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
            margin-bottom: 15px;
            flex-shrink: 0;
        }

        .slide-caption {
            flex: 1;
            overflow-y: auto;
            text-align: center;
            padding: 15px;
            font-size: 16px;
            color: #333;
            background: white;
            border-radius: 8px;
            line-height: 1.6;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
            min-height: 60px;
            max-height: 200px;
        }

        .slide-caption::-webkit-scrollbar {
            width: 6px;
        }

        .slide-caption::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 3px;
        }

        .slide-caption::-webkit-scrollbar-thumb {
            background: #888;
            border-radius: 3px;
        }

        .slide-caption::-webkit-scrollbar-thumb:hover {
            background: #555;
        }

        .slider-nav {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 20px;
            padding: 10px;
            flex-shrink: 0;
        }

        .slider-dot {
            width: 12px;
            height: 12px;
            border-radius: 50%;
            background: #ddd;
            cursor: pointer;
            transition: all 0.3s;
        }

        .slider-dot:hover {
            background: #aaa;
        }

        .slider-dot.active {
            background: var(--secondary);
            transform: scale(1.2);
        }

        .slider-arrow {
            position: absolute;
            top: 50%;
            transform: translateY(-50%);
            background: rgba(0, 0, 0, 0.6);
            color: white;
            border: none;
            width: 50px;
            height: 50px;
            border-radius: 50%;
            font-size: 24px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 5;
            transition: all 0.3s;
        }

        .slider-arrow:hover {
            background: rgba(0, 0, 0, 0.8);
            transform: translateY(-50%) scale(1.1);
        }

        .slider-arrow.prev {
            left: 20px;
        }

        .slider-arrow.next {
            right: 20px;
        }

        .slider-controls {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 20px;
            margin-top: 10px;
            flex-shrink: 0;
            padding: 10px;
        }

        .auto-play-btn {
            background: var(--primary);
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }

        .auto-play-btn:hover {
            background: #0c2238;
        }

        /* ================= FOOTER ================= */
        .kcgi-footer {
            background: #0f2a44;
            color: #eaf1ff;
            text-align: center;
            padding: 12px 10px;
            font-size: 13px;
            border-top: 2px solid var(--secondary);
        }

        .kcgi-footer span {
            font-weight: bold;
            color: #ffd966;
            margin: 0 4px;
        }

        /* Add download button style */
        .card-buttons {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-top: 15px;
        }

        .download-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 14px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .download-btn:hover {
            background: #218838;
        }
    </style>
</head>

<body>

    <!-- ================= MENU ================= -->
    <nav>
        <div class="menu">
            <div class="menu-item">
                <a href="#" class="menu-link">üè´ Campus Info ‚ñæ</a>
                <div class="dropdown">
                    <a href="#ekimae">Ekimae Campus</a>
                    <a href="#hblock">Hyakumanben (H Block)</a>
                    <a href="#mblock">Hyakumanben (M Block)</a>
                </div>
            </div>
            <div class="menu-item">
                <a href="#" class="menu-link">üìö Academic Help ‚ñæ</a>
                <div class="dropdown">
                    <a href="main.png">Add / Drop Subjects</a>
                    <a href="#problems">Attendance</a>
                    <a href="#problems">Assignments</a>
                    <a href="#problems">Wi-Fi Guide</a>
                </div>
            </div>
            <div class="menu-item">
                <a href="#" class="menu-link">üè† Daily Life in Kyoto ‚ñæ</a>
                <div class="dropdown">
                    <a href="https://kyoto-kogomi.net/wp-content/uploads/2024/01/gominowakekatadashikataleafleten.pdf"
                        target="_blank">üóë Garbage PDF</a>
                    <a href="https://www.youtube.com/watch?v=Z3p0eYKFedU&t=179s" target="_blank">üöá Transport Guide</a>
                    <a href="https://www.youtube.com/watch?v=xmK3tolUeF0" target="_blank">üõí Gyomu Super</a>
                    <a href="https://www.youtube.com/watch?v=LB9Gh3xPUMA&t=258s" target="_blank">üó£ Japanese
                        Greetings</a>
                </div>
            </div>
        </div>
    </nav>

    <!-- ================= HEADER ================= -->
    <header class="kcgi-header">
        <img src="logo.svg" alt="KCGI Logo" class="kcgi-logo">
        <div class="kcgi-title">
            <h1>KCGI Student Support Portal</h1>
            <p>Scan ‚Ä¢ Listen ‚Ä¢ Navigate ‚Ä¢ Learn</p>
            <div class="badge">Project by Group 17</div>
        </div>
    </header>

    <!-- ================= BUILDINGS ================= -->
    <section id="ekimae">
        <h2>üè¢ Campus Buildings</h2>
        <div class="card-container">

            <!-- Ekimae -->
            <div class="card" id="ekimaeCard">
                <img src="ekimae.png" class="card-map">
                <h3>KCGI Ekimae Campus</h3>
                <div class="info-box" id="buildingA"
                    data-fulltext="KCGI Ekimae Campus is the main academic campus. Most regular classes and academic activities are conducted here.">
                </div>
                <a href="#" class="read-more" onclick="toggleTextDynamic(event, 'buildingA')">Read more</a>
                <button onclick="speakFromBox('buildingA')">üîä Listen Info</button>
                <a href="https://maps.app.goo.gl/MAd9ZF9vq7L3kL4g8" target="_blank">
                    <button>üó∫ Open Google Map</button>
                </a>
            </div>

            <!-- H Block -->
            <div class="card" id="hblock">
                <img src="hblock.png" class="card-map">
                <h3>KCGI Hyakumanben Campus (H Block)</h3>
                <div class="info-box" id="buildingB"
                    data-fulltext="Orientation will be held here at H Block, where students will select their academic concentration, register for subjects, receive guidance on scholarship programs, get their student ID cards, and learn how to use the attendance system. Lectures will take place in both H and M Blocks, so students should check their subject schedules and timetables to know the exact locations.">
                </div>
                <a href="#" class="read-more" onclick="toggleTextDynamic(event, 'buildingB')">Read more</a>
                <button onclick="speakFromBox('buildingB')">üîä Listen Info</button>
                <a href="https://maps.app.goo.gl/MvAhDWuq6gdK68Vc8" target="_blank">
                    <button>üó∫ Open Google Map</button>
                </a>
            </div>

            <!-- M Block -->
            <div class="card" id="mblock">
                <img src="mblock.png" class="card-map">
                <h3>KCGI Hyakumanben Campus (M Block)</h3>
                <div class="info-box" id="buildingC"
                    data-fulltext="M Block is next to H Block. Students can go here for enquiry and help regarding addition or withdrawing subjects and to meet their academic counselors. Lectures will take place in both H and M Blocks, so students should check their subject schedules and timetables to know the exact locations.">
                </div>
                <a href="#" class="read-more" onclick="toggleTextDynamic(event, 'buildingC')">Read more</a>
                <button onclick="speakFromBox('buildingC')">üîä Listen Info</button>
                <a href="https://maps.app.goo.gl/RqeovaRUtw4VrMy29" target="_blank">
                    <button>üó∫ Open Google Map</button>
                </a>
            </div>

        </div>
    </section>

    <!-- ================= PROBLEMS ================= -->
    <!-- ================= PROBLEMS ================= -->
    <section id="problems">
        <h2>‚ùì Student Problems & Solutions</h2>
        <div class="card-container">
            <div class="card">
                <h3>Add / Drop Subjects</h3>
                <div class="card-buttons">
                    <button onclick="openGuide('add_drop')">View Steps</button>
                    <button class="download-btn" onclick="downloadGuide('add_drop')">‚¨á Download</button>
                </div>
            </div>
            <div class="card">
                <h3>Check Attendance</h3>
                <div class="card-buttons">
                    <button onclick="openGuide('attendance')">View Steps</button>
                    <button class="download-btn" onclick="downloadGuide('attendance')">‚¨á Download</button>
                </div>
            </div>
            <div class="card">
                <h3>Check Assignments</h3>
                <div class="card-buttons">
                    <button onclick="openGuide('assignments')">View Steps</button>
                    <button class="download-btn" onclick="downloadGuide('assignments')">‚¨á Download</button>
                </div>
            </div>
            <div class="card">
                <h3>Use Campus Wi-Fi</h3>
                <div class="card-buttons">
                    <button onclick="openGuide('wifi')">View Steps</button>
                    <button class="download-btn" onclick="downloadGuide('wifi')">‚¨á Download</button>
                </div>
            </div>
        </div>
    </section>

    <!-- ================= MODAL WITH SLIDER ================= -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <div class="close" onclick="closeModal()">‚úñ</div>
            <div class="modal-title" id="modalTitle"></div>
            <div class="slider-container">
                <div class="slider-track" id="sliderTrack"></div>
                <button class="slider-arrow prev" onclick="prevSlide()">‚ùÆ</button>
                <button class="slider-arrow next" onclick="nextSlide()">‚ùØ</button>
                <div class="slider-nav" id="sliderNav"></div>
            </div>
            <div class="slider-controls">
                <button class="auto-play-btn" onclick="toggleAutoPlay()" id="autoPlayBtn">‚è∏ Pause Auto-play</button>
                <span id="slideCounter">1/4</span>
            </div>
        </div>
    </div>

    <!-- ================= FOOTER ================= -->
    <footer class="kcgi-footer">
        Project by Group 17:
        <span>Jeevan Subedi (M25W7486)</span>,
        <span>Uddin Borhan ()</span>,
        <span>Ahmed Md Jonayed (M25W7647)</span>,
        <span>Baskota Prekshya (M25W7529)</span>,
        <span>Hossain Yeakub (M25W7526)</span>,
        <span>Dawadi Ramesh (M25W7556)</span>,
        <span>Islam Md Jahirul ()</span>
    </footer>

    <script>
        const previewLength = 180; // characters to show in preview

        // Define image sets for each guide
        const guideImages = {
            'add_drop_pre': {
                title: 'Add / Drop Subjects Guide',
                images: [
                    { src: 'subject_Check/1.jpg', caption: 'Steps 1: Login to CampusPortal -> Home -> Campus Plan Web Menu' },
                    { src: 'subject_Check/2.jpg', caption: 'Step 2: Login using your student credentials ' },
                    { src: 'subject_Check/4.jpg', caption: 'Step 3: Web Syllabus' },
                    { src: 'subject_Check/5.jpg', caption: 'Step 4: Search Syllabus' },
                    { src: 'subject_Check/3.jpg', caption: 'Select your Semester-> Select Day-> Search -> You will see all the subjects scheduled for that day' },
                ]
            }, 'add_drop': {
                title: 'Add / Drop Subjects Guide',
                images: [
                    { src: 'Addition_Withdraw/1.jpg', caption: 'Steps 1: Login to KingLMS -> Organisations -> KCGI Students Web' },
                    { src: 'Addition_Withdraw/2.png', caption: 'Step 2: Scroll down to the Addition Withdraw -> Select the Manual And Read the Instructions ' },
                    { src: 'Addition_Withdraw/4.jpg', caption: 'Step 3: Refer this Presentation file with all the steps to add or withdraw subjects' },
                    { src: 'Addition_Withdraw/5.jpg', caption: 'Step 4: Proceed to add or withdraw subjects' },
                    { src: 'Addition_Withdraw/3.jpg', caption: 'Disclaimer "Addition and Withdraw is only available from 5:00 AM to 17:00 PM' },
                ]
            },
            'assignments': {
                title: 'Check Assignments Guide',
                images: [
                    {
                        src: 'assignments_1.png',
                        caption: 'Step 1: Go to the assignments section in your course management system.'
                    },
                    {
                        src: 'assignments_2.png',
                        caption: 'Step 2: Check all assignment deadlines and submission requirements.'
                    },
                    {
                        src: 'assignments_3.png',
                        caption: 'Step 3: Download all necessary assignment files and materials.'
                    },
                    {
                        src: 'assignments_4.png',
                        caption: 'Step 4: Submit completed work before the deadline and keep a backup.'
                    }
                ]
            },
            'wifi': {
                title: 'Use Campus Wi-Fi Guide',
                images: [
                    {
                        src: 'wifi_1.png',
                        caption: 'Step 1: Connect to KCGI-WiFi network from your device settings.'
                    },
                    {
                        src: 'wifi_2.png',
                        caption: 'Step 2: Enter your student credentials when prompted.'
                    },
                    {
                        src: 'wifi_3.png',
                        caption: 'Step 3: Accept the security certificate if prompted by browser.'
                    },
                    {
                        src: 'wifi_4.png',
                        caption: 'Step 4: Test your connection by accessing the student portal.'
                    }
                ]
            }
        };

        // Current slider state
        let currentSlideIndex = 0;
        let currentGuide = '';
        let autoSlideInterval = null;
        let isAutoPlay = true;

        // Initialize preview text dynamically
        document.querySelectorAll('.info-box').forEach(box => {
            const fullText = box.dataset.fulltext;
            if (fullText.length > previewLength) {
                box.innerText = fullText.substring(0, previewLength) + '...';
                box.dataset.expanded = "false";
            } else {
                box.innerText = fullText;
                box.dataset.expanded = "true";
            }
        });

        // Toggle Read More / Show Less dynamically
        function toggleTextDynamic(e, id) {
            e.preventDefault();
            const box = document.getElementById(id);
            const fullText = box.dataset.fulltext;
            const expanded = box.dataset.expanded === "true";

            if (expanded) {
                // Collapse
                box.innerText = fullText.substring(0, previewLength) + '...';
                box.dataset.expanded = "false";
                e.target.innerText = "Read more";
            } else {
                // Expand
                box.innerText = fullText;
                box.dataset.expanded = "true";
                e.target.innerText = "Show less";
            }
        }

        // Speech function reads full text
        function speakFromBox(id) {
            const box = document.getElementById(id);
            const fullText = box.dataset.fulltext;
            speechSynthesis.cancel();
            const msg = new SpeechSynthesisUtterance(fullText);
            msg.lang = "en-US";
            msg.rate = 0.95;
            speechSynthesis.speak(msg);
        }

        // Initialize slider for a specific guide
        function initSlider(guideName) {
            const guide = guideImages[guideName];
            const sliderTrack = document.getElementById('sliderTrack');
            const sliderNav = document.getElementById('sliderNav');
            const modalTitle = document.getElementById('modalTitle');

            // Set modal title
            modalTitle.textContent = guide.title;

            // Clear existing content
            sliderTrack.innerHTML = '';
            sliderNav.innerHTML = '';

            // Create slides
            guide.images.forEach((image, index) => {
                // Create slide
                const slide = document.createElement('div');
                slide.className = 'slide';
                slide.innerHTML = `
                    <div class="slide-content">
                        <img src="${image.src}" alt="Step ${index + 1}" onerror="this.src='placeholder.png'">
                        <div class="slide-caption">${image.caption}</div>
                    </div>
                `;
                sliderTrack.appendChild(slide);

                // Create navigation dot
                const dot = document.createElement('div');
                dot.className = `slider-dot ${index === 0 ? 'active' : ''}`;
                dot.onclick = () => goToSlide(index);
                sliderNav.appendChild(dot);
            });

            currentSlideIndex = 0;
            updateSliderPosition();
            if (isAutoPlay) {
                startAutoSlide();
                autoSlideInterval = setInterval(nextSlide, 4000);

            }
            updateSlideCounter();
        }

        // Update slider position
        function updateSliderPosition() {
            const sliderTrack = document.getElementById('sliderTrack');
            sliderTrack.style.transform = `translateX(-${currentSlideIndex * 100}%)`;

            // Update active dot
            document.querySelectorAll('.slider-dot').forEach((dot, index) => {
                dot.classList.toggle('active', index === currentSlideIndex);
            });

            updateSlideCounter();
        }

        // Update slide counter
        function updateSlideCounter() {
            if (currentGuide) {
                const totalSlides = guideImages[currentGuide].images.length;
                document.getElementById('slideCounter').textContent =
                    `${currentSlideIndex + 1}/${totalSlides}`;
            }
        }

        // Navigate to specific slide
        function goToSlide(index) {
            const guide = guideImages[currentGuide];
            if (guide && index >= 0 && index < guide.images.length) {
                currentSlideIndex = index;
                updateSliderPosition();
                resetAutoSlide();
            }
        }

        // Next slide
        function nextSlide() {
            const guide = guideImages[currentGuide];
            if (guide) {
                currentSlideIndex = (currentSlideIndex + 1) % guide.images.length;
                updateSliderPosition();
                resetAutoSlide();
            }
        }

        // Previous slide
        function prevSlide() {
            const guide = guideImages[currentGuide];
            if (guide) {
                currentSlideIndex = (currentSlideIndex - 1 + guide.images.length) % guide.images.length;
                updateSliderPosition();
                resetAutoSlide();
            }
        }

        // Start auto slide
        function startAutoSlide() {
            stopAutoSlide();
            autoSlideInterval = setInterval(nextSlide, 4000); // Change slide every 4 seconds
        }

        // Stop auto slide
        function stopAutoSlide() {
            if (autoSlideInterval) {
                clearInterval(autoSlideInterval);
                autoSlideInterval = null;
            }
        }

        // Toggle auto play
        function toggleAutoPlay() {
            isAutoPlay = !isAutoPlay;
            const btn = document.getElementById('autoPlayBtn');

            if (isAutoPlay) {
                btn.textContent = '‚è∏ Pause Auto-play';
                startAutoSlide();
            } else {
                btn.textContent = '‚ñ∂ Resume Auto-play';
                stopAutoSlide();
            }
        }

        // Reset auto slide timer
        function resetAutoSlide() {
            if (isAutoPlay) {
                stopAutoSlide();
                startAutoSlide();
            }
        }

        // Open guide with slider
        function openGuide(guideName) {
            currentGuide = guideName;
            document.getElementById("modal").style.display = "flex";
            initSlider(guideName);
        }

        // Close modal
        function closeModal() {
            document.getElementById("modal").style.display = "none";
            stopAutoSlide();
        }

        // Dropdown toggle
        document.querySelectorAll('.menu-link').forEach(link => {
            link.addEventListener('click', function (e) {
                e.preventDefault();
                const parent = this.parentElement;
                parent.classList.toggle('active');
                document.querySelectorAll('.menu-item').forEach(item => {
                    if (item !== parent) item.classList.remove('active');
                });
            });
        });

        document.addEventListener('click', function (e) {
            if (!e.target.closest('.menu')) {
                document.querySelectorAll('.menu-item').forEach(item => item.classList.remove('active'));
            }
        });

        // Pause auto-slide when modal is hovered
        document.getElementById('modal').addEventListener('mouseenter', function () {
            if (isAutoPlay) {
                stopAutoSlide();
            }
        });

        document.getElementById('modal').addEventListener('mouseleave', function () {
            if (isAutoPlay) {
                startAutoSlide();
            }
        });

        // Close modal when clicking outside
        window.addEventListener('click', function (e) {
            if (e.target === document.getElementById('modal')) {
                closeModal();
            }
        });

        // Keyboard navigation
        document.addEventListener('keydown', function (e) {
            if (document.getElementById('modal').style.display === 'flex') {
                if (e.key === 'ArrowLeft') {
                    prevSlide();
                } else if (e.key === 'ArrowRight') {
                    nextSlide();
                } else if (e.key === 'Escape') {
                    closeModal();
                } else if (e.key === ' ') {
                    e.preventDefault();
                    toggleAutoPlay();
                }
            }
        });
        // Download guide as PDF function
        // Download guide as JPEG function
        function downloadGuide(guideName) {
            // Assuming you have JPEG files named like: add_drop_1.jpg, add_drop_2.jpg, etc.
            // Download the first image of each guide
            const jpgUrl = `main.png`;
            const link = document.createElement('a');
            link.href = jpgUrl;
            link.download = `KCGI_${guideName.replace('_', ' ')}_Guide.jpg`;
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);

            alert(`Downloading ${guideName.replace('_', ' ')} Guide (first image)...`);
        }
    </script>
</body>

</html>